# tcpdump Component

```
type:   tcpdump
exe:    phenix-scorch-component-tcpdump
stages: start, stop
```

It is assumed that the `tcpdump` executable is present in any VMs this component will be executed against.

## Metadata Options

```yaml
metadata:
    bootstrapServers: [<string>]
    allScan: <bool> #boolean indicating if all data should be scanned
    critLoad: <string> #string indicated critical load to scan for
    mode: <string>  #string that can be 'substation', 'critical load', or 'all data'
    substation: <string> #name of substation to scan for
    csv: <bool> #boolean indicating if the output should be a csv
```

No defaults exist for the `hostname` and `iface` options. They must be provided. As of right now, the `iface` value must represent the name of the interface in the VM. In the future, it will also support the name of the interface referenced in the phenix topology file for the VM.

The `filter` and `options` VM options are optional.

The `tcpdump` component code automatically adds the `-i <iface>`, `-U`, and `-w <path>` options to the command before being executed.

The `convertToJSON` option is important if Filebeat is going to be used to process the results of the traffic capture to send to Elastic. By default it is disabled since it can take a while to complete.

The `filebeat.inputs` section above can be blindly copied into user's own config and used as-is, or users can choose to change target field names if the ones used above aren't suitable.

> In the future, user components will have the ability to modify the
> `filebeat.inputs` section of component metadata directly so users don't have
> to know how the logs generated by components need to be processed.

## Example Configuration

```yaml
metadata:
    bootstrapServers: ["172.20.0.74:9092"]
    allScan: false
    critLoad: ""
    mode: "all data"
    substation: ""
    csv: true
```
